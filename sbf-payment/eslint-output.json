[{"filePath":"C:\\Users\\posta\\Desktop\\SBF\\sbf-payment\\src\\app\\actions.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'redirect' is defined but never used.","line":7,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":18}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use server'\r\n\r\nimport { prisma } from \"@/lib/prisma\";\r\nimport { revalidatePath } from \"next/cache\";\r\nimport { writeFile } from \"fs/promises\";\r\nimport { join } from \"path\";\r\nimport { redirect } from \"next/navigation\";\r\n\r\nexport async function submitPayment(formData: FormData) {\r\n    const tcNo = formData.get(\"tcNo\") as string;\r\n    const fullName = formData.get(\"fullName\") as string;\r\n    const studentNo = formData.get(\"studentNo\") as string;\r\n    const facilityId = formData.get(\"facilityId\") as string;\r\n    const receiptFile = formData.get(\"receipt\") as File;\r\n\r\n    // Temel validasyon\r\n    if (!tcNo || !fullName || !studentNo || !facilityId || !receiptFile) {\r\n        return { error: \"Lütfen tüm alanları doldurunuz.\" };\r\n    }\r\n\r\n    if (tcNo.length !== 11) {\r\n        return { error: \"Geçersiz T.C. Kimlik No.\" };\r\n    }\r\n\r\n    // Dosya kaydetme\r\n    let receiptPath = \"\";\r\n    try {\r\n        const bytes = await receiptFile.arrayBuffer();\r\n        const buffer = Buffer.from(bytes);\r\n\r\n        // Benzersiz dosya adı oluştur\r\n        const uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9);\r\n        const originalName = receiptFile.name.replace(/\\s+/g, '-').toLowerCase();\r\n        const filename = `${uniqueSuffix}-${originalName}`;\r\n\r\n        // public/uploads klasörüne kaydet\r\n        // Not: Production ortamında object storage (S3 vb.) önerilir, bu basit implementation'dır.\r\n        const uploadDir = join(process.cwd(), \"public/uploads\");\r\n        const filepath = join(uploadDir, filename);\r\n\r\n        // Klasör yoksa oluşturmak gerekebilir ama kurulumda oluşturduk varsayalım veya bir helper ile yapalım\r\n        // fs/promises'de mkdir recursive option'ı var ama burada basitce writeFile kullanıyoruz,\r\n        // klasörün var olduğundan emin olunmalı.\r\n\r\n        await writeFile(filepath, buffer);\r\n        receiptPath = `/uploads/${filename}`;\r\n    } catch (error) {\r\n        console.error(\"Dosya yükleme hatası:\", error);\r\n        return { error: \"Dosya yüklenirken bir sorun oluştu.\" };\r\n    }\r\n\r\n    // Sabit alanlar dışındaki verileri extraData olarak topla\r\n    const fixedKeys = [\"tcNo\", \"fullName\", \"studentNo\", \"facilityId\", \"receipt\"];\r\n    const extraDataObj: Record<string, string> = {};\r\n\r\n    formData.forEach((value, key) => {\r\n        if (!fixedKeys.includes(key)) {\r\n            extraDataObj[key] = value as string;\r\n        }\r\n    });\r\n\r\n    const extraData = JSON.stringify(extraDataObj);\r\n\r\n    try {\r\n        await prisma.submission.create({\r\n            data: {\r\n                tcNo,\r\n                fullName,\r\n                studentNo,\r\n                facilityId,\r\n                receiptPath,\r\n                extraData,\r\n                status: \"pending\",\r\n            },\r\n        });\r\n    } catch (error) {\r\n        console.error(\"Veritabanı hatası:\", error);\r\n        return { error: \"Başvuru kaydedilirken veritabanı hatası oluştu.\" };\r\n    }\r\n\r\n    revalidatePath(\"/admin/submissions\");\r\n    return { success: true };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\posta\\Desktop\\SBF\\sbf-payment\\src\\app\\admin\\(protected)\\facilities\\AddFacilityForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\posta\\Desktop\\SBF\\sbf-payment\\src\\app\\admin\\(protected)\\facilities\\DeleteFacilityButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\posta\\Desktop\\SBF\\sbf-payment\\src\\app\\admin\\(protected)\\facilities\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\posta\\Desktop\\SBF\\sbf-payment\\src\\app\\admin\\(protected)\\forms\\AddFormFieldForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\posta\\Desktop\\SBF\\sbf-payment\\src\\app\\admin\\(protected)\\forms\\FormFieldList.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":19,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[788,791],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[788,791],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { deleteFormField, toggleFormFieldActive } from \"../../form-actions\";\r\nimport { Button } from \"@/components/ui/button\";\r\n\r\nimport { Trash2, Eye, EyeOff } from \"lucide-react\";\r\nimport { useTransition } from \"react\";\r\n\r\n// Badge bileşenini burada inline tanımlayalım hızlıca\r\nfunction Badge({ variant = \"default\", children }: { variant?: \"default\" | \"secondary\" | \"destructive\", children: React.ReactNode }) {\r\n    const classes = {\r\n        default: \"bg-primary/10 text-primary\",\r\n        secondary: \"bg-secondary text-secondary-foreground\",\r\n        destructive: \"bg-red-100 text-red-700\"\r\n    }\r\n    return <span className={`px-2 py-0.5 rounded text-xs font-medium ${classes[variant]}`}>{children}</span>\r\n}\r\n\r\nexport function FormFieldList({ fields }: { fields: any[] }) {\r\n    return (\r\n        <div className=\"space-y-4\">\r\n            {fields.length === 0 ? (\r\n                <div className=\"text-center p-4 text-muted-foreground\">Ekstra form alanı bulunmuyor.</div>\r\n            ) : (\r\n                <div className=\"grid gap-3\">\r\n                    {fields.map((field) => (\r\n                        <div key={field.id} className=\"flex items-center justify-between p-4 border rounded-lg bg-card hover:bg-muted/20 transition-colors\">\r\n                            <div className=\"flex items-center gap-3\">\r\n                                <div className={`w-2 h-2 rounded-full ${field.isActive ? 'bg-green-500' : 'bg-gray-300'}`} />\r\n                                <div>\r\n                                    <div className=\"font-medium\">{field.label}</div>\r\n                                    <div className=\"flex items-center gap-2 mt-1\">\r\n                                        <Badge variant=\"secondary\">{field.type}</Badge>\r\n                                        {!field.isActive && <Badge variant=\"destructive\">Pasif</Badge>}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"flex items-center gap-2\">\r\n                                <ToggleActiveButton id={field.id} isActive={field.isActive} />\r\n                                <DeleteFieldButton id={field.id} />\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction DeleteFieldButton({ id }: { id: string }) {\r\n    const [isPending, startTransition] = useTransition();\r\n    return (\r\n        <Button\r\n            variant=\"ghost\"\r\n            size=\"icon\"\r\n            className=\"text-red-500 hover:text-red-700 hover:bg-red-50\"\r\n            disabled={isPending}\r\n            onClick={() => {\r\n                if (confirm(\"Bu alanı silmek istediğinize emin misiniz?\")) {\r\n                    startTransition(async () => {\r\n                        await deleteFormField(id);\r\n                    });\r\n                }\r\n            }}\r\n        >\r\n            <Trash2 className=\"w-4 h-4\" />\r\n        </Button>\r\n    )\r\n}\r\n\r\nfunction ToggleActiveButton({ id, isActive }: { id: string, isActive: boolean }) {\r\n    const [isPending, startTransition] = useTransition();\r\n    return (\r\n        <Button\r\n            variant=\"ghost\"\r\n            size=\"icon\"\r\n            className=\"text-muted-foreground hover:text-foreground\"\r\n            disabled={isPending}\r\n            onClick={() => {\r\n                startTransition(async () => {\r\n                    await toggleFormFieldActive(id, isActive);\r\n                });\r\n            }}\r\n            title={isActive ? \"Pasif Yap\" : \"Aktif Yap\"}\r\n        >\r\n            {isActive ? <Eye className=\"w-4 h-4\" /> : <EyeOff className=\"w-4 h-4\" />}\r\n        </Button>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\posta\\Desktop\\SBF\\sbf-payment\\src\\app\\admin\\(protected)\\forms\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\posta\\Desktop\\SBF\\sbf-payment\\src\\app\\admin\\(protected)\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\posta\\Desktop\\SBF\\sbf-payment\\src\\app\\admin\\(protected)\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Button' is defined but never used.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { prisma } from \"@/lib/prisma\";\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { FileCheck, Clock, CheckCircle2, XCircle } from \"lucide-react\";\r\nimport Link from \"next/link\";\r\nimport { Button } from \"@/components/ui/button\";\r\n\r\nexport default async function AdminDashboard() {\r\n    const [totalSubmissions, pendingSubmissions, approvedSubmissions, rejectedSubmissions] = await Promise.all([\r\n        prisma.submission.count(),\r\n        prisma.submission.count({ where: { status: \"pending\" } }),\r\n        prisma.submission.count({ where: { status: \"approved\" } }),\r\n        prisma.submission.count({ where: { status: \"rejected\" } }),\r\n    ]);\r\n\r\n    const recentSubmissions = await prisma.submission.findMany({\r\n        take: 5,\r\n        orderBy: { createdAt: \"desc\" },\r\n        include: { facility: true },\r\n    });\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <h2 className=\"text-3xl font-bold tracking-tight\">Genel Bakış</h2>\r\n\r\n            <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\r\n                <StatCard\r\n                    title=\"Toplam Başvuru\"\r\n                    value={totalSubmissions}\r\n                    icon={<FileCheck className=\"h-4 w-4 text-muted-foreground\" />}\r\n                />\r\n                <StatCard\r\n                    title=\"Bekleyen Onay\"\r\n                    value={pendingSubmissions}\r\n                    icon={<Clock className=\"h-4 w-4 text-orange-500\" />}\r\n                />\r\n                <StatCard\r\n                    title=\"Onaylanan\"\r\n                    value={approvedSubmissions}\r\n                    icon={<CheckCircle2 className=\"h-4 w-4 text-green-500\" />}\r\n                />\r\n                <StatCard\r\n                    title=\"Reddedilen\"\r\n                    value={rejectedSubmissions}\r\n                    icon={<XCircle className=\"h-4 w-4 text-red-500\" />}\r\n                />\r\n            </div>\r\n\r\n            <div className=\"space-y-4\">\r\n                <div className=\"flex items-center justify-between\">\r\n                    <h3 className=\"text-xl font-semibold text-[#152746]\">Son Başvurular</h3>\r\n                    <Link\r\n                        href=\"/admin/submissions\"\r\n                        className=\"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 border border-[#152746]/20 shadow-sm h-8 px-3 text-xs bg-white hover:bg-gray-50 text-[#152746]\"\r\n                    >\r\n                        Tümünü Gör\r\n                    </Link>\r\n                </div>\r\n\r\n                <div className=\"border border-gray-200 rounded-lg bg-white shadow-sm overflow-hidden\">\r\n                    <div className=\"relative w-full overflow-auto\">\r\n                        <table className=\"w-full caption-bottom text-sm text-left\">\r\n                            <thead className=\"bg-gray-50 border-b border-gray-100\">\r\n                                <tr className=\"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\">\r\n                                    <th className=\"h-12 px-4 align-middle font-semibold text-[#152746]\">Öğrenci</th>\r\n                                    <th className=\"h-12 px-4 align-middle font-semibold text-[#152746]\">Tesis</th>\r\n                                    <th className=\"h-12 px-4 align-middle font-semibold text-[#152746]\">Tutar</th>\r\n                                    <th className=\"h-12 px-4 align-middle font-semibold text-[#152746]\">Durum</th>\r\n                                    <th className=\"h-12 px-4 align-middle font-semibold text-[#152746]\">Tarih</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody className=\"[&_tr:last-child]:border-0 bg-white\">\r\n                                {recentSubmissions.length === 0 ? (\r\n                                    <tr>\r\n                                        <td colSpan={5} className=\"p-8 text-center text-gray-400\">Henüz başvuru bulunmuyor.</td>\r\n                                    </tr>\r\n                                ) : (\r\n                                    recentSubmissions.map((sub) => (\r\n                                        <tr key={sub.id} className=\"border-b border-gray-100 transition-colors hover:bg-blue-50/50\">\r\n                                            <td className=\"p-4 align-middle\">\r\n                                                <div className=\"font-medium text-gray-900\">{sub.fullName}</div>\r\n                                                <div className=\"text-xs text-gray-500\">{sub.studentNo}</div>\r\n                                            </td>\r\n                                            <td className=\"p-4 align-middle text-gray-700\">{sub.facility.name}</td>\r\n                                            <td className=\"p-4 align-middle text-gray-700\">{sub.facility.price} TL</td>\r\n                                            <td className=\"p-4 align-middle\">\r\n                                                <StatusBadge status={sub.status} />\r\n                                            </td>\r\n                                            <td className=\"p-4 align-middle text-gray-500\">\r\n                                                {new Date(sub.createdAt).toLocaleDateString('tr-TR')}\r\n                                            </td>\r\n                                        </tr>\r\n                                    ))\r\n                                )}\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction StatCard({ title, value, icon }: { title: string, value: number, icon: React.ReactNode }) {\r\n    return (\r\n        <Card className=\"bg-white border border-gray-200 shadow-sm hover:shadow-md transition-shadow\">\r\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                <CardTitle className=\"text-sm font-medium text-gray-600\">\r\n                    {title}\r\n                </CardTitle>\r\n                {icon}\r\n            </CardHeader>\r\n            <CardContent>\r\n                <div className=\"text-2xl font-bold text-[#152746]\">{value}</div>\r\n            </CardContent>\r\n        </Card>\r\n    )\r\n}\r\n\r\nfunction StatusBadge({ status }: { status: string }) {\r\n    const styles = {\r\n        pending: \"bg-orange-100 text-orange-700 border border-orange-200\",\r\n        approved: \"bg-green-100 text-green-700 border border-green-200\",\r\n        rejected: \"bg-red-100 text-red-700 border border-red-200\",\r\n    };\r\n\r\n    const labels = {\r\n        pending: \"Bekliyor\",\r\n        approved: \"Onaylandı\",\r\n        rejected: \"Reddedildi\",\r\n    };\r\n\r\n    return (\r\n        <span className={`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold ${styles[status as keyof typeof styles]}`}>\r\n            {labels[status as keyof typeof labels] || status}\r\n        </span>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\posta\\Desktop\\SBF\\sbf-payment\\src\\app\\admin\\(protected)\\submissions\\SubmissionDetails.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Calendar' is defined but never used.","line":5,"column":30,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":38},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":7,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":7,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[347,350],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[347,350],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[391,394],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[391,394],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\nimport React from 'react';\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\r\nimport { FileText, Download, Calendar } from \"lucide-react\";\r\n\r\nexport function SubmissionDetails({ submission }: { submission: any }) {\r\n    let extraData: Record<string, any> = {};\r\n    try {\r\n        if (submission.extraData) {\r\n            extraData = JSON.parse(submission.extraData);\r\n        }\r\n    } catch (e) {\r\n        console.error(\"JSON parse error\", e);\r\n    }\r\n\r\n    return (\r\n        <Dialog>\r\n            <DialogTrigger>\r\n                <Button size=\"sm\" variant=\"outline\" className=\"h-8 gap-2 text-blue-600 border-blue-200 hover:bg-blue-50\">\r\n                    <FileText className=\"w-4 h-4\" />\r\n                    Detay\r\n                </Button>\r\n            </DialogTrigger>\r\n            <DialogContent className=\"sm:max-w-md\">\r\n                <DialogHeader>\r\n                    <DialogTitle className=\"text-[#152746]\">Başvuru Detayları</DialogTitle>\r\n                    <DialogDescription>\r\n                        {submission.fullName} - {submission.studentNo}\r\n                    </DialogDescription>\r\n                </DialogHeader>\r\n\r\n                <div className=\"grid gap-4 py-4 max-h-[60vh] overflow-y-auto pr-2\">\r\n                    {/* Temel Bilgiler */}\r\n                    <div className=\"space-y-2 p-3 bg-gray-50 rounded-md border text-sm\">\r\n                        <h4 className=\"font-semibold text-[#152746] border-b pb-1 mb-2\">Temel Bilgiler</h4>\r\n                        <div className=\"grid grid-cols-1 gap-y-2\">\r\n                            <div className=\"flex justify-between\">\r\n                                <span className=\"text-gray-500\">TC Kimlik:</span>\r\n                                <span className=\"font-medium text-gray-900\">{submission.tcNo}</span>\r\n                            </div>\r\n                            <div className=\"flex justify-between\">\r\n                                <span className=\"text-gray-500\">Tesis:</span>\r\n                                <span className=\"font-medium text-gray-900\">{submission.facility.name}</span>\r\n                            </div>\r\n                            <div className=\"flex justify-between\">\r\n                                <span className=\"text-gray-500\">Tutar:</span>\r\n                                <span className=\"font-medium text-gray-900\">{submission.facility.price} TL</span>\r\n                            </div>\r\n                            <div className=\"flex justify-between\">\r\n                                <span className=\"text-gray-500\">Tarih:</span>\r\n                                <span className=\"font-medium text-gray-900\">{new Date(submission.createdAt).toLocaleDateString('tr-TR')} {new Date(submission.createdAt).toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit' })}</span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Dinamik Alanlar */}\r\n                    {Object.keys(extraData).length > 0 && (\r\n                        <div className=\"space-y-2 p-3 bg-blue-50/50 rounded-md border border-blue-100 text-sm\">\r\n                            <h4 className=\"font-semibold text-[#152746] border-b border-blue-200 pb-1 mb-2\">Form Yanıtları</h4>\r\n                            <div className=\"grid grid-cols-1 gap-y-2\">\r\n                                {Object.entries(extraData).map(([key, value]) => {\r\n                                    // Key'i (örn: \"kac_yasindasin\") daha düzgün göstermek mümkünse formField listesinden label aranabilir ama şu an key gösterelim\r\n                                    // Veya key'i capitalize yapalım.\r\n                                    return (\r\n                                        <div key={key} className=\"flex flex-col sm:flex-row sm:justify-between gap-1\">\r\n                                            <span className=\"text-gray-500 font-medium capitalize\">{key}:</span>\r\n                                            <span className=\"text-gray-900 break-all sm:text-right\">{String(value)}</span>\r\n                                        </div>\r\n                                    );\r\n                                })}\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Dekont */}\r\n                    <div className=\"pt-2\">\r\n                        <a\r\n                            href={submission.receiptPath}\r\n                            target=\"_blank\"\r\n                            className=\"flex items-center justify-center w-full gap-2 p-2 rounded-md bg-[#152746] text-white hover:bg-[#152746]/90 transition-colors text-sm font-medium\"\r\n                        >\r\n                            <Download className=\"w-4 h-4\" />\r\n                            Dekontu Görüntüle\r\n                        </a>\r\n                    </div>\r\n                </div>\r\n            </DialogContent>\r\n        </Dialog>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\posta\\Desktop\\SBF\\sbf-payment\\src\\app\\admin\\(protected)\\submissions\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardHeader' is defined but never used.","line":5,"column":29,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":39},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardTitle' is defined but never used.","line":5,"column":41,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":50},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardDescription' is defined but never used.","line":5,"column":52,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":67},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'revalidatePath' is defined but never used.","line":7,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":24}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { prisma } from \"@/lib/prisma\";\r\nimport { updateSubmissionStatus } from \"../../actions\";\r\nimport { SubmissionDetails } from \"./SubmissionDetails\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\r\nimport { ExternalLink, Check, X, Clock } from \"lucide-react\";\r\nimport { revalidatePath } from \"next/cache\";\r\n\r\nexport const dynamic = 'force-dynamic';\r\n\r\nexport default async function SubmissionsPage() {\r\n    const submissions = await prisma.submission.findMany({\r\n        orderBy: { createdAt: \"desc\" },\r\n        include: { facility: true },\r\n    });\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <div>\r\n                <h2 className=\"text-3xl font-bold tracking-tight\">Ödeme Bildirimleri</h2>\r\n                <p className=\"text-muted-foreground\">Öğrencilerden gelen ödeme bildirimlerini inceleyin ve onaylayın.</p>\r\n            </div>\r\n\r\n            <Card>\r\n                <CardContent className=\"p-0 overflow-hidden\">\r\n                    <div className=\"overflow-x-auto\">\r\n                        <table className=\"w-full text-sm text-left\">\r\n                            <thead className=\"bg-muted/50 text-muted-foreground uppercase font-medium text-xs\">\r\n                                <tr>\r\n                                    <th className=\"px-6 py-4\">Tarih</th>\r\n                                    <th className=\"px-6 py-4\">Öğrenci Bilgileri</th>\r\n                                    <th className=\"px-6 py-4\">Tesis / Tutar</th>\r\n                                    <th className=\"px-6 py-4\">Dekont</th>\r\n                                    <th className=\"px-6 py-4 text-center\">Durum</th>\r\n                                    <th className=\"px-6 py-4 text-right\">İşlemler</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody className=\"divide-y divide-border\">\r\n                                {submissions.length === 0 ? (\r\n                                    <tr>\r\n                                        <td colSpan={6} className=\"px-6 py-8 text-center text-muted-foreground\">\r\n                                            Kaydedilmiş başvuru bulunmuyor.\r\n                                        </td>\r\n                                    </tr>\r\n                                ) : (\r\n                                    submissions.map((sub) => (\r\n                                        <tr key={sub.id} className=\"hover:bg-muted/30 transition-colors\">\r\n                                            <td className=\"px-6 py-4 whitespace-nowrap text-muted-foreground\">\r\n                                                {new Date(sub.createdAt).toLocaleDateString('tr-TR')}\r\n                                                <br />\r\n                                                <span className=\"text-xs\">{new Date(sub.createdAt).toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit' })}</span>\r\n                                            </td>\r\n                                            <td className=\"px-6 py-4\">\r\n                                                <div className=\"font-semibold\">{sub.fullName}</div>\r\n                                                <div className=\"text-xs text-muted-foreground\">Oğr. No: {sub.studentNo}</div>\r\n                                                <div className=\"text-xs text-muted-foreground\">TC: {sub.tcNo}</div>\r\n                                            </td>\r\n                                            <td className=\"px-6 py-4\">\r\n                                                <div className=\"font-medium\">{sub.facility.name}</div>\r\n                                                <div className=\"text-xs font-semibold text-primary\">{sub.facility.price} TL</div>\r\n                                            </td>\r\n                                            <td className=\"px-6 py-4\">\r\n                                                <a\r\n                                                    href={sub.receiptPath}\r\n                                                    target=\"_blank\"\r\n                                                    rel=\"noopener noreferrer\"\r\n                                                    className=\"inline-flex items-center text-blue-600 hover:text-blue-800 hover:underline\"\r\n                                                >\r\n                                                    <ExternalLink className=\"w-4 h-4 mr-1\" />\r\n                                                    Görüntüle\r\n                                                </a>\r\n                                            </td>\r\n                                            <td className=\"px-6 py-4 text-center\">\r\n                                                <StatusBadge status={sub.status} />\r\n                                            </td>\r\n                                            <td className=\"px-6 py-4 text-right\">\r\n                                                <div className=\"flex items-center justify-end gap-2\">\r\n                                                    <SubmissionDetails submission={{\r\n                                                        ...sub,\r\n                                                        createdAt: sub.createdAt.toISOString(),\r\n                                                        updatedAt: sub.updatedAt.toISOString()\r\n                                                    }} />\r\n                                                    {sub.status === 'pending' && (\r\n                                                        <>\r\n                                                            <form action={async () => {\r\n                                                                'use server';\r\n                                                                await updateSubmissionStatus(sub.id, 'approved');\r\n                                                            }}>\r\n                                                                <Button size=\"sm\" variant=\"outline\" className=\"h-8 w-8 p-0 text-green-600 border-green-200 hover:bg-green-50 hover:text-green-700\">\r\n                                                                    <Check className=\"w-4 h-4\" />\r\n                                                                </Button>\r\n                                                            </form>\r\n                                                            <form action={async () => {\r\n                                                                'use server';\r\n                                                                await updateSubmissionStatus(sub.id, 'rejected');\r\n                                                            }}>\r\n                                                                <Button size=\"sm\" variant=\"outline\" className=\"h-8 w-8 p-0 text-red-600 border-red-200 hover:bg-red-50 hover:text-red-700\">\r\n                                                                    <X className=\"w-4 h-4\" />\r\n                                                                </Button>\r\n                                                            </form>\r\n                                                        </>\r\n                                                    )}\r\n                                                    {sub.status !== 'pending' && (\r\n                                                        <form action={async () => {\r\n                                                            'use server';\r\n                                                            await updateSubmissionStatus(sub.id, 'pending');\r\n                                                        }}>\r\n                                                            <Button size=\"sm\" variant=\"ghost\" className=\"h-8 text-xs text-muted-foreground\">\r\n                                                                Geri Al\r\n                                                            </Button>\r\n                                                        </form>\r\n                                                    )}\r\n                                                </div>\r\n                                            </td>\r\n                                        </tr>\r\n                                    ))\r\n                                )}\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                </CardContent>\r\n            </Card>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction StatusBadge({ status }: { status: string }) {\r\n    const styles = {\r\n        pending: \"bg-orange-100 text-orange-700 border-orange-200\",\r\n        approved: \"bg-green-100 text-green-700 border-green-200\",\r\n        rejected: \"bg-red-100 text-red-700 border-red-200\",\r\n    };\r\n\r\n    const icons = {\r\n        pending: <Clock className=\"w-3 h-3 mr-1\" />,\r\n        approved: <Check className=\"w-3 h-3 mr-1\" />,\r\n        rejected: <X className=\"w-3 h-3 mr-1\" />,\r\n    };\r\n\r\n    const labels = {\r\n        pending: \"Bekliyor\",\r\n        approved: \"Onaylandı\",\r\n        rejected: \"Reddedildi\",\r\n    };\r\n\r\n    return (\r\n        <span className={`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium border ${styles[status as keyof typeof styles]}`}>\r\n            {icons[status as keyof typeof icons]}\r\n            {labels[status as keyof typeof labels] || status}\r\n        </span>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\posta\\Desktop\\SBF\\sbf-payment\\src\\app\\admin\\actions.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":28,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":28,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":39,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":39,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":55,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":55,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use server'\r\n\r\nimport { prisma } from \"@/lib/prisma\";\r\nimport { revalidatePath } from \"next/cache\";\r\n\r\n// --- Facility Actions ---\r\n\r\nexport async function addFacility(formData: FormData) {\r\n    const name = formData.get(\"name\") as string;\r\n    const price = parseFloat(formData.get(\"price\") as string);\r\n    const description = formData.get(\"description\") as string;\r\n\r\n    if (!name || isNaN(price)) {\r\n        return { error: \"Geçersiz veriler.\" };\r\n    }\r\n\r\n    try {\r\n        await prisma.facility.create({\r\n            data: {\r\n                name,\r\n                price,\r\n                description,\r\n            },\r\n        });\r\n        revalidatePath(\"/admin/facilities\");\r\n        revalidatePath(\"/\"); // Ana sayfadaki dropdown da güncellensin\r\n        return { success: true };\r\n    } catch (error) {\r\n        return { error: \"Tesis eklenirken hata oluştu.\" };\r\n    }\r\n}\r\n\r\nexport async function deleteFacility(id: string) {\r\n    try {\r\n        await prisma.facility.delete({ where: { id } });\r\n        revalidatePath(\"/admin/facilities\");\r\n        revalidatePath(\"/\");\r\n        return { success: true };\r\n    } catch (error) {\r\n        return { error: \"Silinirken hata oluştu.\" };\r\n    }\r\n}\r\n\r\n// --- Submission Actions ---\r\n\r\nexport async function updateSubmissionStatus(id: string, status: string) {\r\n    try {\r\n        await prisma.submission.update({\r\n            where: { id },\r\n            data: { status },\r\n        });\r\n        revalidatePath(\"/admin/submissions\");\r\n        revalidatePath(\"/admin\");\r\n        return { success: true };\r\n    } catch (error) {\r\n        return { error: \"Güncellenirken hata oluştu.\" };\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\posta\\Desktop\\SBF\\sbf-payment\\src\\app\\admin\\form-actions.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":42,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":42,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":53,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":53,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":67,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":67,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use server'\r\n\r\nimport { prisma } from \"@/lib/prisma\";\r\nimport { revalidatePath } from \"next/cache\";\r\n\r\nexport async function addFormField(formData: FormData) {\r\n    const label = formData.get(\"label\") as string;\r\n    const type = formData.get(\"type\") as string; // text, number, date, select\r\n    const options = formData.get(\"options\") as string; // virgülle ayrılmış\r\n\r\n    if (!label || !type) {\r\n        return { error: \"Label ve tip zorunludur.\" };\r\n    }\r\n\r\n    // Slug benzeri name oluştur\r\n    const name = label.toLowerCase()\r\n        .replace(/ğ/g, 'g').replace(/ü/g, 'u').replace(/ş/g, 's')\r\n        .replace(/ı/g, 'i').replace(/ö/g, 'o').replace(/ç/g, 'c')\r\n        .replace(/[^a-z0-9]/g, '_');\r\n\r\n    // Son sıradakini bul ve +1 ekle\r\n    const lastField = await prisma.formField.findFirst({\r\n        orderBy: { order: 'desc' },\r\n    });\r\n    const order = (lastField?.order || 0) + 1;\r\n\r\n    try {\r\n        await prisma.formField.create({\r\n            data: {\r\n                name,\r\n                label,\r\n                type,\r\n                required: false, // Varsayılan olarak zorunlu değil yapalım şimdilik\r\n                options: options ? JSON.stringify(options.split(',').map(s => s.trim())) : null,\r\n                order,\r\n                isSystem: false,\r\n            },\r\n        });\r\n        revalidatePath(\"/admin/forms\");\r\n        revalidatePath(\"/\");\r\n        return { success: true };\r\n    } catch (error) {\r\n        return { error: \"Alan eklenirken hata oluştu.\" };\r\n    }\r\n}\r\n\r\nexport async function deleteFormField(id: string) {\r\n    try {\r\n        await prisma.formField.delete({ where: { id } });\r\n        revalidatePath(\"/admin/forms\");\r\n        revalidatePath(\"/\");\r\n        return { success: true };\r\n    } catch (error) {\r\n        return { error: \"Silinirken hata oluştu.\" };\r\n    }\r\n}\r\n\r\nexport async function toggleFormFieldActive(id: string, currentState: boolean) {\r\n    try {\r\n        await prisma.formField.update({\r\n            where: { id },\r\n            data: { isActive: !currentState },\r\n        });\r\n        revalidatePath(\"/admin/forms\");\r\n        revalidatePath(\"/\");\r\n        return { success: true };\r\n    } catch (error) {\r\n        return { error: \"Güncellenirken hata oluştu.\" };\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\posta\\Desktop\\SBF\\sbf-payment\\src\\app\\admin\\login\\LoginForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\posta\\Desktop\\SBF\\sbf-payment\\src\\app\\admin\\login\\SetupForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\posta\\Desktop\\SBF\\sbf-payment\\src\\app\\admin\\login\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\posta\\Desktop\\SBF\\sbf-payment\\src\\app\\api\\auth\\[...nextauth]\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\posta\\Desktop\\SBF\\sbf-payment\\src\\app\\components\\PaymentFormClient.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":41,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":41,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1323,1326],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1323,1326],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":72,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":72,"endColumn":19}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport { Upload, CheckCircle2, AlertCircle } from \"lucide-react\";\r\nimport { submitPayment } from \"../actions\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Select } from \"@/components/ui/select\";\r\n\r\ninterface Facility {\r\n    id: string;\r\n    name: string;\r\n    price: number;\r\n}\r\n\r\ninterface FormField {\r\n    id: string;\r\n    name: string;\r\n    label: string;\r\n    type: string;\r\n    required: boolean;\r\n    options: string | null;\r\n}\r\n\r\ninterface PaymentFormClientProps {\r\n    facilities: Facility[];\r\n    extraFields: FormField[];\r\n}\r\n\r\nexport function PaymentFormClient({ facilities, extraFields }: PaymentFormClientProps) {\r\n    const [isSubmitting, setIsSubmitting] = useState(false);\r\n    const [submitResult, setSubmitResult] = useState<{ success?: boolean; error?: string } | null>(null);\r\n    const { register, handleSubmit, formState: { errors }, watch, reset } = useForm();\r\n\r\n    const selectedFacilityId = watch(\"facilityId\");\r\n    const selectedFacility = facilities.find(f => f.id === selectedFacilityId);\r\n\r\n    async function onSubmit(data: any) {\r\n        setIsSubmitting(true);\r\n        setSubmitResult(null);\r\n\r\n        const formData = new FormData();\r\n        // Sabit alanlar\r\n        formData.append(\"tcNo\", data.tcNo);\r\n        formData.append(\"fullName\", data.fullName);\r\n        formData.append(\"studentNo\", data.studentNo);\r\n        formData.append(\"facilityId\", data.facilityId);\r\n        if (data.receipt[0]) {\r\n            formData.append(\"receipt\", data.receipt[0]);\r\n        }\r\n\r\n        // Dinamik alanları da ekle\r\n        if (extraFields) {\r\n            extraFields.forEach(field => {\r\n                if (data[field.name]) {\r\n                    formData.append(field.name, data[field.name]);\r\n                }\r\n            });\r\n        }\r\n\r\n        try {\r\n            const result = await submitPayment(formData);\r\n            if (result.error) {\r\n                setSubmitResult({ error: result.error });\r\n            } else {\r\n                setSubmitResult({ success: true });\r\n                reset();\r\n            }\r\n        } catch (e) {\r\n            setSubmitResult({ error: \"Beklenmedik bir hata oluştu.\" });\r\n        } finally {\r\n            setIsSubmitting(false);\r\n        }\r\n    }\r\n\r\n    if (submitResult?.success) {\r\n        return (\r\n            <motion.div\r\n                initial={{ opacity: 0, scale: 0.9 }}\r\n                animate={{ opacity: 1, scale: 1 }}\r\n                className=\"text-center p-8 bg-green-50 rounded-2xl border border-green-100\"\r\n            >\r\n                <CheckCircle2 className=\"w-16 h-16 text-green-600 mx-auto mb-4\" />\r\n                <h3 className=\"text-2xl font-bold text-green-700 mb-2\">Başvuru Alındı!</h3>\r\n                <p className=\"text-green-600 mb-6\">\r\n                    Ödeme bildiriminiz başarıyla sisteme kaydedildi.\r\n                </p>\r\n                <Button\r\n                    variant=\"outline\"\r\n                    className=\"border-green-600 text-green-700 hover:bg-green-50\"\r\n                    onClick={() => setSubmitResult(null)}\r\n                >\r\n                    Yeni Başvuru Yap\r\n                </Button>\r\n            </motion.div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-6\">\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"tcNo\" className=\"text-gray-700 font-medium\">T.C. Kimlik Numarası</Label>\r\n                    <Input\r\n                        id=\"tcNo\"\r\n                        placeholder=\"11 haneli T.C. No\"\r\n                        maxLength={11}\r\n                        className=\"bg-white border-gray-300 focus:border-[#152746] focus:ring-[#152746] h-11\"\r\n                        {...register(\"tcNo\", { required: true, minLength: 11, maxLength: 11 })}\r\n                    />\r\n                    {errors.tcNo && <span className=\"text-sm text-red-500\">T.C. Kimlik No zorunludur (11 hane)</span>}\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"studentNo\" className=\"text-gray-700 font-medium\">Öğrenci Numarası</Label>\r\n                    <Input\r\n                        id=\"studentNo\"\r\n                        placeholder=\"Okul Numaranız\"\r\n                        className=\"bg-white border-gray-300 focus:border-[#152746] focus:ring-[#152746] h-11\"\r\n                        {...register(\"studentNo\", { required: true })}\r\n                    />\r\n                    {errors.studentNo && <span className=\"text-sm text-red-500\">Öğrenci No zorunludur</span>}\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n                <Label htmlFor=\"fullName\" className=\"text-gray-700 font-medium\">Adı Soyadı</Label>\r\n                <Input\r\n                    id=\"fullName\"\r\n                    placeholder=\"Adınız ve Soyadınız\"\r\n                    className=\"bg-white border-gray-300 focus:border-[#152746] focus:ring-[#152746] h-11\"\r\n                    {...register(\"fullName\", { required: true })}\r\n                />\r\n                {errors.fullName && <span className=\"text-sm text-red-500\">Ad Soyad zorunludur</span>}\r\n            </div>\r\n\r\n            {/* Dinamik Alanlar */}\r\n            {extraFields && extraFields.map((field) => (\r\n                <div key={field.id} className=\"space-y-2\">\r\n                    <Label htmlFor={field.name} className=\"text-gray-700 font-medium\">{field.label}</Label>\r\n                    {field.type === 'text' && (\r\n                        <Input\r\n                            id={field.name}\r\n                            className=\"bg-white border-gray-300 focus:border-[#152746] focus:ring-[#152746] h-11\"\r\n                            {...register(field.name, { required: field.required })}\r\n                        />\r\n                    )}\r\n                    {field.type === 'number' && (\r\n                        <Input\r\n                            id={field.name}\r\n                            type=\"number\"\r\n                            className=\"bg-white border-gray-300 focus:border-[#152746] focus:ring-[#152746] h-11\"\r\n                            {...register(field.name, { required: field.required })}\r\n                        />\r\n                    )}\r\n                    {field.type === 'date' && (\r\n                        <Input\r\n                            id={field.name}\r\n                            type=\"date\"\r\n                            className=\"bg-white border-gray-300 focus:border-[#152746] focus:ring-[#152746] h-11\"\r\n                            {...register(field.name, { required: field.required })}\r\n                        />\r\n                    )}\r\n                    {field.type === 'select' && field.options && (\r\n                        <Select\r\n                            id={field.name}\r\n                            className=\"bg-white border-gray-300 focus:border-[#152746] focus:ring-[#152746] h-11\"\r\n                            {...register(field.name, { required: field.required })}\r\n                        >\r\n                            <option value=\"\">Seçiniz</option>\r\n                            {(JSON.parse(field.options) as string[]).map((opt, i) => (\r\n                                <option key={i} value={opt}>{opt}</option>\r\n                            ))}\r\n                        </Select>\r\n                    )}\r\n                </div>\r\n            ))}\r\n\r\n            <div className=\"space-y-2\">\r\n                <Label htmlFor=\"facilityId\" className=\"text-gray-700 font-medium\">Kullanılacak Tesis</Label>\r\n                <Select\r\n                    id=\"facilityId\"\r\n                    className=\"bg-white border-gray-300 focus:border-[#152746] focus:ring-[#152746] h-11\"\r\n                    {...register(\"facilityId\", { required: true })}\r\n                >\r\n                    <option value=\"\">Seçiniz...</option>\r\n                    {facilities.map((f) => (\r\n                        <option key={f.id} value={f.id}>\r\n                            {f.name} - {f.price} TL\r\n                        </option>\r\n                    ))}\r\n                </Select>\r\n                {errors.facilityId && <span className=\"text-sm text-red-500\">Lütfen bir tesis seçiniz</span>}\r\n            </div>\r\n\r\n            <AnimatePresence>\r\n                {selectedFacility && (\r\n                    <motion.div\r\n                        initial={{ opacity: 0, height: 0 }}\r\n                        animate={{ opacity: 1, height: 'auto' }}\r\n                        exit={{ opacity: 0, height: 0 }}\r\n                        className=\"bg-[#152746]/5 rounded-lg p-4 border border-[#152746]/10\"\r\n                    >\r\n                        <div className=\"flex justify-between items-center text-[#152746] font-medium\">\r\n                            <span>Ödenecek Tutar:</span>\r\n                            <span className=\"text-xl font-bold\">{selectedFacility.price} TL</span>\r\n                        </div>\r\n                    </motion.div>\r\n                )}\r\n            </AnimatePresence>\r\n\r\n            <div className=\"space-y-2\">\r\n                <Label htmlFor=\"receipt\" className=\"text-gray-700 font-medium\">Dekont Yükle (PDF veya Fotoğraf)</Label>\r\n                <div className=\"border-2 border-dashed border-gray-300 rounded-lg p-8 hover:bg-gray-50 hover:border-[#152746]/50 transition-colors text-center cursor-pointer relative bg-white\">\r\n                    <input\r\n                        type=\"file\"\r\n                        id=\"receipt\"\r\n                        accept=\"image/*,.pdf\"\r\n                        className=\"absolute inset-0 w-full h-full opacity-0 cursor-pointer\"\r\n                        {...register(\"receipt\", { required: true })}\r\n                    />\r\n                    <div className=\"flex flex-col items-center gap-2 text-gray-500 pointer-events-none\">\r\n                        <Upload className=\"w-10 h-10 text-[#152746]/50\" />\r\n                        <span className=\"text-sm font-medium\">Dosya seçmek için tıklayın veya sürükleyin</span>\r\n                    </div>\r\n                </div>\r\n                {errors.receipt && <span className=\"text-sm text-red-500\">Dekont yüklemek zorunludur</span>}\r\n            </div>\r\n\r\n            {submitResult?.error && (\r\n                <div className=\"p-3 rounded-md bg-red-50 text-red-600 text-sm flex items-center gap-2 border border-red-100\">\r\n                    <AlertCircle className=\"w-4 h-4\" />\r\n                    {submitResult.error}\r\n                </div>\r\n            )}\r\n\r\n            <Button\r\n                type=\"submit\"\r\n                className=\"w-full text-lg h-12 bg-[#152746] hover:bg-[#152746]/90 text-white transition-all font-semibold shadow-md hover:shadow-lg\"\r\n                disabled={isSubmitting}\r\n            >\r\n                {isSubmitting ? \"Gönderiliyor...\" : \"Ödeme Bildirimini Gönder\"}\r\n            </Button>\r\n        </form>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\posta\\Desktop\\SBF\\sbf-payment\\src\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\posta\\Desktop\\SBF\\sbf-payment\\src\\app\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\posta\\Desktop\\SBF\\sbf-payment\\src\\components\\ui\\button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\posta\\Desktop\\SBF\\sbf-payment\\src\\components\\ui\\card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\posta\\Desktop\\SBF\\sbf-payment\\src\\components\\ui\\dialog.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'asChild' is defined but never used.","line":21,"column":43,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":50}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\"\r\nimport * as React from \"react\"\r\nimport { cn } from \"@/lib/utils\"\r\nimport { X } from \"lucide-react\"\r\n\r\nconst DialogContext = React.createContext<{\r\n    open: boolean\r\n    onOpenChange: (open: boolean) => void\r\n}>({ open: false, onOpenChange: () => { } })\r\n\r\nexport const Dialog = ({ children }: { children: React.ReactNode }) => {\r\n    const [isOpen, setIsOpen] = React.useState(false)\r\n\r\n    return (\r\n        <DialogContext.Provider value={{ open: isOpen, onOpenChange: setIsOpen }}>\r\n            {children}\r\n        </DialogContext.Provider>\r\n    )\r\n}\r\n\r\nexport const DialogTrigger = ({ children, asChild }: { children: React.ReactNode, asChild?: boolean }) => {\r\n    const { onOpenChange } = React.useContext(DialogContext)\r\n    return (\r\n        <div onClick={(e) => { e.stopPropagation(); onOpenChange(true); }} className=\"cursor-pointer inline-flex\">\r\n            {children}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport const DialogContent = ({ children, className }: { children: React.ReactNode, className?: string }) => {\r\n    const { open, onOpenChange } = React.useContext(DialogContext)\r\n\r\n    // Basit bir body scroll lock\r\n    React.useEffect(() => {\r\n        if (open) {\r\n            document.body.style.overflow = 'hidden'\r\n        } else {\r\n            document.body.style.overflow = 'unset'\r\n        }\r\n        return () => { document.body.style.overflow = 'unset' }\r\n    }, [open])\r\n\r\n    if (!open) return null\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4\">\r\n            {/* Backdrop */}\r\n            <div\r\n                className=\"absolute inset-0 bg-black/50 backdrop-blur-sm animate-in fade-in duration-200\"\r\n                onClick={() => onOpenChange(false)}\r\n            />\r\n\r\n            {/* Content */}\r\n            <div className={cn(\r\n                \"relative z-10 grid w-full max-w-lg gap-4 border bg-white p-6 shadow-lg duration-200 animate-in fade-in zoom-in-95 rounded-lg\",\r\n                className\r\n            )}>\r\n                <button\r\n                    onClick={() => onOpenChange(false)}\r\n                    className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\"\r\n                >\r\n                    <X className=\"h-4 w-4\" />\r\n                    <span className=\"sr-only\">Kapat</span>\r\n                </button>\r\n                {children}\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport const DialogHeader = ({ children, className }: { children: React.ReactNode, className?: string }) => (\r\n    <div className={cn(\"flex flex-col space-y-1.5 text-center sm:text-left\", className)}>{children}</div>\r\n)\r\n\r\nexport const DialogTitle = ({ children, className }: { children: React.ReactNode, className?: string }) => (\r\n    <h2 className={cn(\"text-lg font-semibold leading-none tracking-tight\", className)}>{children}</h2>\r\n)\r\n\r\nexport const DialogDescription = ({ children, className }: { children: React.ReactNode, className?: string }) => (\r\n    <p className={cn(\"text-sm text-muted-foreground\", className)}>{children}</p>\r\n)\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\posta\\Desktop\\SBF\\sbf-payment\\src\\components\\ui\\input.tsx","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":4,"column":18,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":4,"endColumn":28,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[75,156],"text":"type InputProps = React.InputHTMLAttributes<HTMLInputElement>"},"desc":"Replace empty interface with a type alias."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nexport interface InputProps\r\n    extends React.InputHTMLAttributes<HTMLInputElement> { }\r\n\r\nconst Input = React.forwardRef<HTMLInputElement, InputProps>(\r\n    ({ className, type, ...props }, ref) => {\r\n        return (\r\n            <input\r\n                type={type}\r\n                className={cn(\r\n                    \"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50\",\r\n                    className\r\n                )}\r\n                ref={ref}\r\n                {...props}\r\n            />\r\n        )\r\n    }\r\n)\r\nInput.displayName = \"Input\"\r\n\r\nexport { Input }\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\posta\\Desktop\\SBF\\sbf-payment\\src\\components\\ui\\label.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\posta\\Desktop\\SBF\\sbf-payment\\src\\components\\ui\\select.tsx","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":4,"column":18,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":4,"endColumn":29,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[75,159],"text":"type SelectProps = React.SelectHTMLAttributes<HTMLSelectElement>"},"desc":"Replace empty interface with a type alias."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nexport interface SelectProps\r\n    extends React.SelectHTMLAttributes<HTMLSelectElement> { }\r\n\r\nconst Select = React.forwardRef<HTMLSelectElement, SelectProps>(\r\n    ({ className, children, ...props }, ref) => {\r\n        return (\r\n            <div className=\"relative\">\r\n                <select\r\n                    className={cn(\r\n                        \"flex h-9 w-full items-center justify-between rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 appearance-none\",\r\n                        className\r\n                    )}\r\n                    ref={ref}\r\n                    {...props}\r\n                >\r\n                    {children}\r\n                </select>\r\n                <span className=\"absolute right-3 top-2.5 pointer-events-none opacity-50\">\r\n                    ▼\r\n                </span>\r\n            </div>\r\n        )\r\n    }\r\n)\r\nSelect.displayName = \"Select\"\r\n\r\nexport { Select }\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\posta\\Desktop\\SBF\\sbf-payment\\src\\lib\\actions.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":42,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":42,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1165,1168],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1165,1168],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":63,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":63,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1815,1818],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1815,1818],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use server';\r\n\r\nimport { signIn } from '@/lib/auth';\r\nimport { AuthError } from 'next-auth';\r\nimport { prisma } from \"@/lib/prisma\";\r\nimport bcrypt from \"bcryptjs\";\r\n\r\nexport async function setupAdmin(formData: FormData) {\r\n    const email = formData.get(\"email\") as string;\r\n    const password = formData.get(\"password\") as string;\r\n\r\n    if (!email || !password || password.length < 6) {\r\n        return { error: \"Geçersiz email veya şifre (min 6 karakter).\" };\r\n    }\r\n\r\n    try {\r\n        const userCount = await prisma.user.count();\r\n        if (userCount > 0) {\r\n            return { error: \"Sistemde zaten yönetici var. Giriş yapınız.\" };\r\n        }\r\n\r\n        const hashedPassword = await bcrypt.hash(password, 10);\r\n\r\n        await prisma.user.create({\r\n            data: {\r\n                email,\r\n                password: hashedPassword,\r\n                name: \"Yönetici\",\r\n                role: \"admin\"\r\n            }\r\n        });\r\n\r\n        return { success: true };\r\n\r\n    } catch (error) {\r\n        console.error(\"Setup error:\", error);\r\n        return { error: \"Kurulum hatası.\" };\r\n    }\r\n}\r\n\r\nexport async function authenticate(\r\n    prevState: any,\r\n    formData: FormData,\r\n) {\r\n    try {\r\n        await signIn('credentials', {\r\n            email: formData.get('email'),\r\n            password: formData.get('password'),\r\n            redirect: false,\r\n        });\r\n        return { success: true };\r\n    } catch (error) {\r\n        if (error instanceof AuthError) {\r\n            switch (error.type) {\r\n                case 'CredentialsSignin':\r\n                    return { error: 'Hatalı e-posta veya şifre.' };\r\n                default:\r\n                    return { error: 'Bir sorun oluştu.' };\r\n            }\r\n        }\r\n\r\n        // Next.js Redirect Hatası Kontrolü\r\n        if ((error as any)?.digest?.startsWith?.('NEXT_REDIRECT')) {\r\n            return { success: true };\r\n        }\r\n\r\n        throw error;\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\posta\\Desktop\\SBF\\sbf-payment\\src\\lib\\auth.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":51,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":51,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1891,1894],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1891,1894],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import NextAuth from \"next-auth\";\r\nimport Credentials from \"next-auth/providers/credentials\";\r\nimport { prisma } from \"@/lib/prisma\";\r\nimport bcrypt from \"bcryptjs\";\r\nimport { z } from \"zod\";\r\n\r\nasync function getUser(email: string) {\r\n    try {\r\n        const user = await prisma.user.findUnique({\r\n            where: { email },\r\n        });\r\n        return user;\r\n    } catch (error) {\r\n        console.error(\"Failed to fetch user:\", error);\r\n        throw new Error(\"Failed to fetch user.\");\r\n    }\r\n}\r\n\r\nexport const { handlers, auth, signIn, signOut } = NextAuth({\r\n    pages: {\r\n        signIn: \"/admin/login\",\r\n    },\r\n    // Secret'ı hardcoded fallback olarak ekliyoruz çünkü env okunamazsa hata veriyor\r\n    secret: process.env.NEXTAUTH_SECRET || \"gizli-bir-super-secret-key-123456-change-me\",\r\n    providers: [\r\n        Credentials({\r\n            async authorize(credentials) {\r\n                const parsedCredentials = z\r\n                    .object({ email: z.string().email(), password: z.string().min(6) })\r\n                    .safeParse(credentials);\r\n\r\n                if (parsedCredentials.success) {\r\n                    const { email, password } = parsedCredentials.data;\r\n                    const user = await getUser(email);\r\n                    if (!user) return null;\r\n\r\n                    const passwordsMatch = await bcrypt.compare(password, user.password);\r\n                    if (passwordsMatch) return user;\r\n                }\r\n\r\n                console.log(\"Invalid credentials\");\r\n                return null;\r\n            },\r\n        }),\r\n    ],\r\n    callbacks: {\r\n        async session({ session, token }) {\r\n            // Token'dan user id'yi session'a ekle\r\n            if (token.sub && session.user) {\r\n                // session.user.id normalde tiplerde yok, extend etmek gerekir ama şimdilik JS tarafında çalışır\r\n                (session.user as any).id = token.sub;\r\n            }\r\n            return session;\r\n        },\r\n    },\r\n});\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\posta\\Desktop\\SBF\\sbf-payment\\src\\lib\\prisma.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\posta\\Desktop\\SBF\\sbf-payment\\src\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
